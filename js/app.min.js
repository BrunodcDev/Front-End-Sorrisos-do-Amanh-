// JavaScript Minificado - Sorrisos do Amanh√£ - v1.0
console.log("=== SORRISOS DO AMANH√É - INICIANDO ===");
const STORAGE_KEY = "sorrisos_voluntarios";
const templates = {
  home: `<section class="hero"><div class="hero-card"><h2>Transforme vidas com um sorriso</h2><p>Na <strong>Sorrisos do Amanh√£</strong> promovemos educa√ß√£o, alimenta√ß√£o e atividades culturais para crian√ßas em situa√ß√£o de vulnerabilidade.</p><div class="cta-row"><a href="#/cadastro" class="botao">Seja volunt√°rio</a><a href="#/projetos" class="botao-secundario">Conhe√ßa os projetos</a></div></div><div class="hero-img"><img src="img/criancas-sorrindo.png" alt="Crian√ßas sorrindo"></div></section><div class="grid-destaque"><div class="card"><h3>Voluntariado</h3><p>Envolva-se com atividades educativas, culturais e de apoio alimentar.</p></div><div class="card"><h3>Doa√ß√µes</h3><p>Contribua para garantir refei√ß√µes e materiais para as atividades.</p></div><div class="card"><h3>Transpar√™ncia</h3><p>Divulgamos relat√≥rios e resultados das a√ß√µes.</p></div></div>`,
  projetos: `<section style="padding:20px"><h2 style="text-align:center;color:#2b6ca3;margin-bottom:30px">Nossos Projetos</h2><div class="cards-projetos"><div class="card-projeto"><div class="card-imagem"><img src="img/projeto-educar.png" alt="Projeto Educa√ß√£o" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjNmNGY2Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzY2NiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9IjAuM2VtIj7imqMgRWR1Y2HDp8OjbzwvdGV4dD48L3N2Zz4='"></div><div class="card-conteudo"><h3>üìö Educa√ß√£o</h3><p>Refor√ßo escolar, oficinas de leitura e inclus√£o digital.</p></div></div><div class="card-projeto"><div class="card-imagem"><img src="img/projeto-alimentar.png" alt="Projeto Alimenta√ß√£o" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjNmNGY2Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzY2NiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9IjAuM2VtIj7imqMgQWxpbWVudGHDp8OjbzwvdGV4dD48L3N2Zz4='"></div><div class="card-conteudo"><h3>üçé Alimenta√ß√£o</h3><p>Refei√ß√µes balanceadas e a√ß√µes de seguran√ßa alimentar.</p></div></div><div class="card-projeto"><div class="card-imagem"><img src="img/projeto-arte.png" alt="Projeto Artes" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjNmNGY2Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzY2NiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9IjAuM2VtIj7imqMgQXJ0ZXM8L3RleHQ+PC9zdmc+='"></div><div class="card-conteudo"><h3>üé® Artes</h3><p>Oficinas de m√∫sica, pintura e teatro para desenvolvimento pessoal.</p></div></div></div></section>`,
};
function navigate() {
  const e = window.location.hash || "#/",
    t = e.replace("#/", "") || "home";
  console.log("Navegando para:", t);
  const n = document.getElementById("conteudo");
  if (!n)
    return (
      console.error("Elemento #conteudo n√£o encontrado!"),
      void (n.style.opacity = "0")
    );
  setTimeout(() => {
    (n.innerHTML = templates[t] || templates.home),
      (n.style.opacity = "1"),
      initializePage(t);
  }, 200);
}
function initializePage(e) {
  console.log("Inicializando p√°gina:", e);
  const t = document.querySelector("nav ul");
  t && t.classList.remove("ativo"),
    "cadastro" === e ? initializeForm() : "admin" === e && initializeAdmin();
}
function initializeForm() {
  console.log("üìù Inicializando formul√°rio completo...");
  const e = document.getElementById("formVoluntario"),
    t = document.getElementById("msgSucesso");
  if (!e)
    return (
      console.error("Formul√°rio n√£o encontrado!"),
      void console.log("‚úÖ Formul√°rio encontrado! Configurando m√°scaras...")
    );
  const n = document.getElementById("cpf");
  n &&
    n.addEventListener("input", function (e) {
      e.target.value = formatarCPF(e.target.value);
    });
  const i = document.getElementById("cep");
  i &&
    i.addEventListener("input", function (e) {
      e.target.value = formatarCEP(e.target.value);
    });
  const a = document.getElementById("telefone");
  a &&
    a.addEventListener("input", function (e) {
      let t = e.target.value.replace(/\D/g, "").slice(0, 11);
      0 === t.length
        ? (e.target.value = "")
        : t.length <= 2
        ? (e.target.value = t)
        : t.length <= 6
        ? (e.target.value = "(" + t.slice(0, 2) + ") " + t.slice(2))
        : t.length <= 10
        ? (e.target.value =
            "(" + t.slice(0, 2) + ") " + t.slice(2, 6) + "-" + t.slice(6))
        : (e.target.value =
            "(" + t.slice(0, 2) + ") " + t.slice(2, 7) + "-" + t.slice(7, 11));
    }),
    e.addEventListener("submit", function (n) {
      n.preventDefault(), console.log("üì§ Formul√°rio completo submetido!");
      const i = {
        nome: document.getElementById("nome").value.trim(),
        cpf: document.getElementById("cpf").value.trim(),
        nascimento: document.getElementById("nascimento").value,
        email: document.getElementById("email").value.trim(),
        telefone: document.getElementById("telefone").value.trim(),
        cep: document.getElementById("cep").value.trim(),
        endereco: document.getElementById("endereco").value.trim(),
        cidade: document.getElementById("cidade").value.trim(),
        estado: document.getElementById("estado").value,
        area: document.getElementById("area").value,
        dias: Array.from(
          document.querySelectorAll('input[name="dias"]:checked')
        ).map((e) => e.value),
        periodo: document.querySelector('input[name="periodo"]:checked')?.value,
        experiencia: document.querySelector('input[name="experiencia"]:checked')
          ?.value,
        mensagem: document.getElementById("mensagem").value.trim(),
        dataCadastro: new Date().toLocaleString("pt-BR"),
        idade: calcularIdade(document.getElementById("nascimento").value),
      };
      console.log("Dados coletados:", i);
      if (!i.nome)
        return (
          alert("‚ùå Por favor, informe seu nome completo."),
          void document.getElementById("nome").focus()
        );
      if (!i.cpf || !/^\d{3}\.\d{3}\.\d{3}-\d{2}$/.test(i.cpf))
        return (
          alert(
            "‚ùå Por favor, insira um CPF v√°lido no formato 000.000.000-00."
          ),
          void document.getElementById("cpf").focus()
        );
      if (!i.nascimento)
        return (
          alert("‚ùå Por favor, informe sua data de nascimento."),
          void document.getElementById("nascimento").focus()
        );
      if (i.idade < 16)
        return (
          alert("‚ùå √â necess√°rio ter pelo menos 16 anos para ser volunt√°rio."),
          void document.getElementById("nascimento").focus()
        );
      if (!i.email || !validarEmail(i.email))
        return (
          alert("‚ùå Por favor, insira um e-mail v√°lido."),
          void document.getElementById("email").focus()
        );
      const a = validarTelefone(i.telefone);
      if (!a.valido)
        return (
          alert(`‚ùå ${a.mensagem}`),
          void document.getElementById("telefone").focus()
        );
      if (!i.area)
        return (
          alert("‚ùå Por favor, selecione uma √°rea de interesse."),
          void document.getElementById("area").focus()
        );
      if (0 === i.dias.length)
        return (
          alert("‚ùå Por favor, selecione pelo menos um dia dispon√≠vel."), void 0
        );
      if (!i.periodo)
        return (
          alert("‚ùå Por favor, selecione um per√≠odo preferencial."), void 0
        );
      try {
        const n = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]"),
          a = n.find((e) => e.cpf === i.cpf);
        if (a)
          return (
            alert("‚ùå Este CPF j√° est√° cadastrado em nosso sistema."),
            void document.getElementById("cpf").focus()
          );
        n.push(i),
          localStorage.setItem(STORAGE_KEY, JSON.stringify(n)),
          console.log("‚úÖ Volunt√°rio salvo com sucesso!"),
          console.log("Total de volunt√°rios:", n.length),
          console.log("Dados salvos:", i),
          t &&
            ((t.style.display = "block"),
            t.scrollIntoView({ behavior: "smooth" })),
          e.reset(),
          setTimeout(() => {
            t && (t.style.display = "none");
          }, 5e3);
      } catch (e) {
        console.error("‚ùå Erro ao salvar no localStorage:", e),
          alert("‚ùå Erro ao salvar cadastro. Por favor, tente novamente.");
      }
    });
}
function formatarCPF(e) {
  return (
    (e = e.replace(/\D/g, "")),
    (e = e.replace(/(\d{3})(\d)/, "$1.$2")),
    (e = e.replace(/(\d{3})(\d)/, "$1.$2")),
    (e = e.replace(/(\d{3})(\d{1,2})$/, "$1-$2")),
    e
  );
}
function formatarCEP(e) {
  return (e = e.replace(/\D/g, "")), (e = e.replace(/(\d{5})(\d)/, "$1-$2")), e;
}
function validarEmail(e) {
  return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e);
}
function calcularIdade(e) {
  const t = new Date(e),
    n = new Date(),
    o = n.getFullYear() - t.getFullYear(),
    i = n.getMonth(),
    a = t.getMonth();
  return i < a || (i === a && n.getDate() < t.getDate()) ? o - 1 : o;
}
function validarTelefone(e) {
  if (!e) return { valido: !1, mensagem: "Por favor, informe um telefone." };
  const t = e.replace(/\D/g, "");
  return t.length < 10 || t.length > 11
    ? {
        valido: !1,
        mensagem:
          "Telefone deve ter 10 ou 11 d√≠gitos. Formato: (00) 00000-0000",
      }
    : /^\(\d{2}\) \d{4,5}-\d{4}$/.test(e)
    ? { valido: !0, mensagem: "Telefone v√°lido" }
    : { valido: !1, mensagem: "Formato inv√°lido. Use: (00) 00000-0000" };
}
function initializeMenu() {
  const e = document.querySelector(".menu-btn"),
    t = document.querySelector("nav ul");
  e &&
    t &&
    e.addEventListener("click", function () {
      t.classList.toggle("ativo");
    });
}
window.addEventListener("load", function () {
  console.log("Aplica√ß√£o carregada!"), initializeMenu(), navigate();
}),
  window.addEventListener("hashchange", navigate),
  (window.debugVoluntarios = function () {
    const e = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");
    return (
      console.log("üìä Volunt√°rios no localStorage:", e),
      console.log("Total:", e.length),
      e
    );
  }),
  console.log("üí° Digite debugVoluntarios() no console para ver os dados!");
